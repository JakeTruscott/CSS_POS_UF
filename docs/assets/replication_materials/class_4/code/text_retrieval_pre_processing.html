<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Truscott (Spring 2026)" />


<title>Text Retrieval and Pre-Processing</title>

<script src="text_retrieval_pre_processing_files/header-attrs-2.28/header-attrs.js"></script>
<script src="text_retrieval_pre_processing_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="text_retrieval_pre_processing_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="text_retrieval_pre_processing_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="text_retrieval_pre_processing_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="text_retrieval_pre_processing_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="text_retrieval_pre_processing_files/navigation-1.1/tabsets.js"></script>
<link href="text_retrieval_pre_processing_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="text_retrieval_pre_processing_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="header">



<h1 class="title toc-ignore">Text Retrieval and Pre-Processing</h1>
<h3 class="subtitle">POS6933: Computational Social Science</h3>
<h4 class="author">Truscott (Spring 2026)</h4>

</div>


<hr />
<div id="text-retrieval" class="section level2">
<h2>Text Retrieval</h2>
<p>There are countless sources of text data – from a single haiku to
bounded volumes providing an expansive anthology of human knowledge, we
can use text analysis tools to bridge an entire domain of qualitative
and quantitative inquiry.</p>
<div id="lies-damn-lies-and-statistics-2000" class="section level3">
<h3>Lies, Damn Lies, and Statistics (2000)</h3>
<p><br></p>
<p><img src="https://raw.githubusercontent.com/JakeTruscott/CSS_POS_UF/5c861826858ba038d1f911e434109e243168c683/docs/assets/replication_materials/class_4/supplemental_materials/west_wing_cast.jpg" alt="West Wing" width="600"></p>
<p><br></p>
<p>Aaron Sorken’s <em>The West Wing</em> (1999-2007) is not only the
best political drama ever created, but I’d go so far as to say it is the
best drama, ever – period. Most public polling concerning the show’s
continued popularity almost 20 years since its end highlights its
staying power. For instance, a survey conducted by <em>Data for
Progress</em> found that 33 percent of Americans had a favorable opinion
of <em>The West Wing</em>, while only 10 percent had an unfavorable
opinion. The same poll also found that the show is more popular among
older, more educated, and higher-income Americans.</p>
<p>One of my favorite episodes is Season 1’s <em>Lies, Damn Lies, and
Statistics</em> – the title originating from a phrase popularized by
Mark Twain (though attributed to British Prime Minister Benjamin
Disraeli) to describe the persuasive power of statistics to bolster
(often weak or subjective) arguments. In this episode, the White House
staff obsess over poll results following a made-for-television fight to
regain control of the American political narrative.</p>
<p>Let’s imagine I wanted to know which character in the episode spoke
the most lines, or maybe even which had the longest dialogue. To do
that, I would need to:</p>
<ul>
<li>Locate the script for the episode
<a href="https://westwingwiki.com/2014/04/season-1-episode-21-lies-damn-lies-statistics/">(Here)</a></li>
<li>Convert it to a plain text format (.txt) – Which I’ve conventiently
done
<a href="https://raw.githubusercontent.com/JakeTruscott/CSS_POS_UF/main/docs/assets/replication_materials/class_4/supplemental_materials/West_Wing_S1_E21.txt">here</a></li>
<li>Load that plain text file into <code>R</code></li>
<li>Process and organize the strings, as well as identify those strings
with their associated characters</li>
<li>Perform analyses on the comparative volume of spoken lines, as well
as the breadth of individual monologues.</li>
</ul>
<pre class="r"><code>west_wing &lt;- readLines(west_wing_script_location, warn = FALSE) # Read Txt from GitHub Repo
head(west_wing) # Print Head</code></pre>
<pre><code>## [1] &quot;THE WEST WING&quot;                     &quot;&#39;LIES, DAMN LIES, AND STATISTICS&#39;&quot;
## [3] &quot;WRITTEN BY: AARON SORKIN&quot;          &quot;DIRECTED BY: DON SCARDINO&quot;        
## [5] &quot;&quot;                                  &quot;TEASER&quot;</code></pre>
<p>Clearly, the text is not as organized as I’d like it to be. My next
steps will be to conciously try to develop a 4-column dataframe that
identifies:</p>
<ul>
<li><b>Character</b>: Which character is currently speaking.</li>
<li><b>Dialogue</b>: The text (string)</li>
<li><b>Word Count</b>: How many words are found in the text</li>
<li><b>Line Number</b>: The current number of dialogue entries to that
point</li>
</ul>
<p>There are several easier ways to do this, but I want to try to be as
precise as I can. I am only interested in Josh, Toby, C.J., Donna, Sam,
Leo, and President Barlet.</p>
<hr />
<pre class="r"><code>west_wing &lt;- data.frame(unlist(west_wing)) %&gt;%
  setNames(&#39;text&#39;)
characters &lt;- c(&#39;Josh&#39;, &#39;Toby&#39;, &#39;C.J.&#39;, &#39;Donna&#39;, &#39;Sam&#39;, &#39;Leo&#39;, &#39;Bartlet&#39;)
character_regex &lt;- paste0(&quot;^(&quot;, paste0(toupper(characters), collapse = &quot;|&quot;), &quot;)$&quot;)

damn_lies &lt;-  west_wing %&gt;%
    mutate(character_line = ifelse(stringr::str_detect(text, character_regex), 1, 0), 
           empty_row = ifelse(text == &#39;&#39;, 1, 0), 
           first_entry = ifelse(character_line == 1, 1, NA)) %&gt;%
    tidyr::fill(first_entry, .direction = &#39;down&#39;) %&gt;%
    filter(!is.na(first_entry)) %&gt;%
    select(-c(first_entry)) %&gt;%
    mutate(group = cumsum(character_line == 1)) %&gt;%
    group_by(group) %&gt;%
    mutate(to_keep = row_number() &lt; which(empty_row == 1)[1] | is.na(which(empty_row == 1)[1])) %&gt;%
    ungroup() %&gt;%
    filter(to_keep) %&gt;%
    select(text, character_line) %&gt;%
    mutate(group = cumsum(character_line == 1)) %&gt;%
    group_by(group) %&gt;%
    summarise(
    character = text[character_line == 1][1],
    dialogue  = paste(text[-1], collapse = &quot; &quot;),
    .groups = &quot;drop&quot;) %&gt;%
    rename(id = group) %&gt;%
    select(character, dialogue, id) %&gt;%
    rowwise() %&gt;%
    mutate(word_count = stringr::str_count(dialogue, &quot;\\S+&quot;)) %&gt;%
    ungroup() %&gt;%
    filter(!word_count == 0)</code></pre>
<pre><code>## # A tibble: 10 × 4
##    character dialogue                                        id word_count
##    &lt;chr&gt;     &lt;chr&gt;                                        &lt;int&gt;      &lt;int&gt;
##  1 DONNA     They got to start the poll, Josh. It&#39;s 7:05.     1          9
##  2 JOSH      It&#39;s ten to seven.                               2          4
##  3 DONNA     No, it&#39;s really not.                             3          4
##  4 JOSH      It&#39;s 7:05?                                       4          2
##  5 DONNA     Yeah.                                            5          1
##  6 JOSH      That&#39;s ridiculous.                               6          2
##  7 DONNA     I&#39;m not making it up.                            7          5
##  8 JOSH      My watch says ten to seven.                      8          6
##  9 DONNA     That&#39;s &#39;cause your watch sucks.                  9          5
## 10 JOSH      My watch is fine.                               10          4</code></pre>
<pre><code>## # A tibble: 7 × 4
##   Character `Total Words` `Average Words` `Total Lines`
##   &lt;chr&gt;             &lt;int&gt;           &lt;dbl&gt;         &lt;int&gt;
## 1 BARTLET            1359               9           145
## 2 C.J.                985              11            91
## 3 JOSH                757              11            67
## 4 LEO                 679               8            90
## 5 TOBY                617               8            78
## 6 SAM                 454               6            75
## 7 DONNA               162               8            20</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
