)
last_line <- trimws(tail(temp_dealer, 1))
temp_dealer_value <- if (grepl("Blackjack", last_line)) {
"Blackjack"
} else if (grepl("Winner", last_line)) {
"21"
} else {
gsub(".*Value:\\s*", "", gsub(' \\(.*', '', last_line))
}
} # Temp Dealer Hand
funds <- if (temp_player_value == 'Blackjack' & !temp_dealer_value == 'Blackjack'){
funds + 150 # 3:2 Payout
} else if (temp_player_value == 'Blackjack' & temp_dealer_value == 'Blackjack'){
funds # Push (Both Blackjack)
} else if (!temp_player_value == 'Blackjack' & temp_dealer_value == 'Blackjack'){
funds - 100 # Loss (Dealer Blackjack)
} else if (as.numeric(temp_player_value) >= 22){
funds - 100
} else if (temp_player_value == temp_dealer_value){
funds # Push
} else if (as.numeric(temp_player_value) <= 21 & as.numeric(temp_dealer_value) >= 22){
funds + 100 # Win w/ Dealer Bust
} else if (as.numeric(temp_player_value) <= 21 & as.numeric(temp_dealer_value) > as.numeric(temp_player_value)){
funds - 100 # Loss w/ Dealer > Player
} else {
funds + 100 # Win w/out Dealer Bust
}
if (funds <= 0){
outcomes[i] <- 0
} else {
outcomes[i] <- funds
} # Append to Outcomes
} # For Each Day (10 Runs)
combined_outcomes[[day]] <- outcomes # Append
if (day %% 10 == 0){
message('Completed ', day, ' of ', length(days))
}
} # 10 Days -- No Funds Replacement...
combined_outcomes <- purrr::imap_dfr(
combined_outcomes,
~ data.frame(run = .y, iteration = seq_along(.x), value = .x)) %>%
filter(iteration == 10) %>%
rename(day = run)
combined_outcomes %>%
ggplot(aes(x = as.numeric(day), y = value)) +
geom_line() +
geom_smooth(method = 'lm', formula = y~x) +
geom_hline(yintercept = 1000, linetype = 2) +
labs(x = '\nDay',
y = 'Remaining Funds\n') +
theme_minimal() +
theme(
panel.border = element_rect(colour = "black", fill = NA),
axis.text = element_text(size = 14, colour = "black"),
axis.title = element_text(size = 16, colour = "black"),
strip.background = element_rect(colour = "black", fill = "grey"),
strip.text = element_text(size = 14, colour = "black"),
legend.position = "none",
legend.title = element_blank(),
legend.background = element_rect(colour = "black", fill = NA),
legend.text = element_text(size = 14, colour = "black"))
set.seed(1234) # Set Random Seed
seeds <- sample(c(1:10000), size= 50, replace = F) # Draw Seeds from seed(1234)
days <- c(1:50)
combined_outcomes <- list()
for (day in 1:length(days)){
if (day == 1){
funds <- 1000 # Start w/ $1000
} else {
funds = combined_outcomes[[day-1]][length(combined_outcomes[[day-1]])] # Else: Grab Funds
}
if (funds == 0){
message('Uh-Oh... You Busted on Day ', day-1, '...')
return(invisible(NULL))
}
temp_day <- days[day]
temp_seed <- seeds[day] # Get Temp Seed
set.seed(temp_seed) # Set Temp Seed
outcomes <- c(rep(NA, 10)) # Empty 10-slot Vector
for (i in seq_len(10)){ # At Most 10 Iterations
if (funds == 0){
outcomes[i] <- 0
next # If 0 -- Move On
}
{
temp_player <- capture.output(
play_blackjack(
role = 'player',
cards = deck,
interactive = FALSE
)
)
last_line <- trimws(tail(temp_player, 1))
temp_player_value <- if (grepl("Blackjack", last_line)) {
"Blackjack"
} else if (grepl("Winner", last_line)) {
"21"
} else {
gsub(".*Value:\\s*", "", gsub(' \\(.*', '', last_line))
}
} # Temp Player Hand
{
temp_dealer <- capture.output(
play_blackjack(
role = 'dealer',
cards = deck,
interactive = FALSE
)
)
last_line <- trimws(tail(temp_dealer, 1))
temp_dealer_value <- if (grepl("Blackjack", last_line)) {
"Blackjack"
} else if (grepl("Winner", last_line)) {
"21"
} else {
gsub(".*Value:\\s*", "", gsub(' \\(.*', '', last_line))
}
} # Temp Dealer Hand
funds <- if (temp_player_value == 'Blackjack' & !temp_dealer_value == 'Blackjack'){
funds + 150 # 3:2 Payout
} else if (temp_player_value == 'Blackjack' & temp_dealer_value == 'Blackjack'){
funds # Push (Both Blackjack)
} else if (!temp_player_value == 'Blackjack' & temp_dealer_value == 'Blackjack'){
funds - 100 # Loss (Dealer Blackjack)
} else if (as.numeric(temp_player_value) >= 22){
funds - 100
} else if (temp_player_value == temp_dealer_value){
funds # Push
} else if (as.numeric(temp_player_value) <= 21 & as.numeric(temp_dealer_value) >= 22){
funds + 100 # Win w/ Dealer Bust
} else if (as.numeric(temp_player_value) <= 21 & as.numeric(temp_dealer_value) > as.numeric(temp_player_value)){
funds - 100 # Loss w/ Dealer > Player
} else {
funds + 100 # Win w/out Dealer Bust
}
if (funds <= 0){
outcomes[i] <- 0
} else {
outcomes[i] <- funds
} # Append to Outcomes
} # For Each Day (10 Runs)
combined_outcomes[[day]] <- outcomes # Append
if (day %% 10 == 0){
message('Completed ', day, ' of ', length(days))
}
} # 10 Days -- No Funds Replacement...
combined_outcomes <- purrr::imap_dfr(
combined_outcomes,
~ data.frame(run = .y, iteration = seq_along(.x), value = .x)) %>%
filter(iteration == 10) %>%
rename(day = run)
set.seed(666) # Set Random Seed
seeds <- sample(c(1:10000), size= 50, replace = F) # Draw Seeds from seed(1234)
days <- c(1:50)
combined_outcomes <- list()
for (day in 1:length(days)){
if (day == 1){
funds <- 1000 # Start w/ $1000
} else {
funds = combined_outcomes[[day-1]][length(combined_outcomes[[day-1]])] # Else: Grab Funds
}
if (funds == 0){
message('Uh-Oh... You Busted on Day ', day-1, '...')
return(invisible(NULL))
}
temp_day <- days[day]
temp_seed <- seeds[day] # Get Temp Seed
set.seed(temp_seed) # Set Temp Seed
outcomes <- c(rep(NA, 10)) # Empty 10-slot Vector
for (i in seq_len(10)){ # At Most 10 Iterations
if (funds == 0){
outcomes[i] <- 0
next # If 0 -- Move On
}
{
temp_player <- capture.output(
play_blackjack(
role = 'player',
cards = deck,
interactive = FALSE
)
)
last_line <- trimws(tail(temp_player, 1))
temp_player_value <- if (grepl("Blackjack", last_line)) {
"Blackjack"
} else if (grepl("Winner", last_line)) {
"21"
} else {
gsub(".*Value:\\s*", "", gsub(' \\(.*', '', last_line))
}
} # Temp Player Hand
{
temp_dealer <- capture.output(
play_blackjack(
role = 'dealer',
cards = deck,
interactive = FALSE
)
)
last_line <- trimws(tail(temp_dealer, 1))
temp_dealer_value <- if (grepl("Blackjack", last_line)) {
"Blackjack"
} else if (grepl("Winner", last_line)) {
"21"
} else {
gsub(".*Value:\\s*", "", gsub(' \\(.*', '', last_line))
}
} # Temp Dealer Hand
funds <- if (temp_player_value == 'Blackjack' & !temp_dealer_value == 'Blackjack'){
funds + 150 # 3:2 Payout
} else if (temp_player_value == 'Blackjack' & temp_dealer_value == 'Blackjack'){
funds # Push (Both Blackjack)
} else if (!temp_player_value == 'Blackjack' & temp_dealer_value == 'Blackjack'){
funds - 100 # Loss (Dealer Blackjack)
} else if (as.numeric(temp_player_value) >= 22){
funds - 100
} else if (temp_player_value == temp_dealer_value){
funds # Push
} else if (as.numeric(temp_player_value) <= 21 & as.numeric(temp_dealer_value) >= 22){
funds + 100 # Win w/ Dealer Bust
} else if (as.numeric(temp_player_value) <= 21 & as.numeric(temp_dealer_value) > as.numeric(temp_player_value)){
funds - 100 # Loss w/ Dealer > Player
} else {
funds + 100 # Win w/out Dealer Bust
}
if (funds <= 0){
outcomes[i] <- 0
} else {
outcomes[i] <- funds
} # Append to Outcomes
} # For Each Day (10 Runs)
combined_outcomes[[day]] <- outcomes # Append
if (day %% 10 == 0){
message('Completed ', day, ' of ', length(days))
}
} # 10 Days -- No Funds Replacement...
combined_outcomes <- purrr::imap_dfr(
combined_outcomes,
~ data.frame(run = .y, iteration = seq_along(.x), value = .x)) %>%
filter(iteration == 10) %>%
rename(day = run)
set.seed(1234) # Set Initial Seed
seeds <-  sample(1:1000, size = 100, replace = FALSE) # Random Seeds
roulette_values <- c(rep("red", 18), rep("black", 18), rep("green", 2)) # Roulette Wheel
games <- c() # Empty Vector to Store Winnings (Losses...)
i = 1
temp_seed <- seeds[i] # Recover Temporary Seed
temp_seed
seeds[1]
set.seed(temp_seed) # Set Temporary Seed
available_colors <- c('red', 'black') # Available Roulette Colors
remaining_funds <- 500 # Starting Money
current_color <- 'red' # Starting with Red
for (spin in 1:100){
temp_spin <- sample(roulette_values, size = 1, replace = T) # Spin!
if (temp_spin == current_color){
remaining_funds <- remaining_funds + 10 # Win :D
current_color = current_color # Keep Color
} else {
remaining_funds <- remaining_funds - 10 # Loss :(
current_color = sample(available_colors[which(!available_colors == current_color)], size = 1, replace = T)
# If Loss -- Remove $10 and Change Color to Other from Remaining Options
}
}
games <- c(games, remaining_funds) # Export Remaining Funds
data.frame(remaining_funds = games) %>%
ggplot(aes(x = remaining_funds)) +
geom_histogram(aes(y = after_stat(density)),
fill = 'skyblue4', colour = 'black', alpha = 1/3, bins = 20) +
geom_density(colour = 'red', linetype = 2, linewidth = 1) +
labs(x = '\nRemaining Funds\n',
y = ' ',
fill = 'Sample Size',
caption = paste0( "Dashed Black Line = Average Remaining Funds Each Day ($", round(mean(games), 0), ")\n",
"Dashed Red Line = Starting Funds ($500)" )) +
geom_vline(xintercept = 500, linetype = 2, colour = 'red') +
geom_vline(xintercept = mean(games), linetype = 2, colour = 'black') +
geom_hline(yintercept = 0) +
theme_minimal() +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
axis.text.x = element_text(size = 12, colour = 'black'),
axis.text.y = element_blank(),
axis.title = element_text(size = 14, colour = 'black'),
strip.background = element_rect(linewidth = 1, colour = 'black', fill = 'grey75'),
strip.text = element_text(size = 12, colour = 'black'),
legend.position = 'none',
plot.caption = element_text(hjust = 0, size = 10))
set.seed(1234) # Set Initial Seed
seeds <-  sample(1:1000, size = 100, replace = FALSE) # Random Seeds
roulette_values <- c(rep("red", 18), rep("black", 18), rep("green", 2)) # Roulette Wheel
games <- c() # Empty Vector to Store Winnings (Losses...)
for (i in 1:length(seeds)){
temp_seed <- seeds[i] # Recover Temporary Seed
set.seed(temp_seed) # Set Temporary Seed
available_colors <- c('red', 'black') # Available Roulette Colors
remaining_funds <- 500 # Starting Money
current_color <- 'red' # Starting with Red
for (spin in 1:100){
temp_spin <- sample(roulette_values, size = 1, replace = T) # Spin!
if (temp_spin == current_color){
remaining_funds <- remaining_funds + 10 # Win :D
current_color = current_color # Keep Color
} else {
remaining_funds <- remaining_funds - 10 # Loss :(
current_color = sample(available_colors[which(!available_colors == current_color)], size = 1, replace = T)
# If Loss -- Remove $10 and Change Color to Other from Remaining Options
}
}
games <- c(games, remaining_funds) # Export Remaining Funds
}
data.frame(remaining_funds = games) %>%
ggplot(aes(x = remaining_funds)) +
geom_histogram(aes(y = after_stat(density)),
fill = 'skyblue4', colour = 'black', alpha = 1/3, bins = 20) +
geom_density(colour = 'red', linetype = 2, linewidth = 1) +
labs(x = '\nRemaining Funds\n',
y = ' ',
fill = 'Sample Size',
caption = paste0( "Dashed Black Line = Average Remaining Funds Each Day ($", round(mean(games), 0), ")\n",
"Dashed Red Line = Starting Funds ($500)" )) +
geom_vline(xintercept = 500, linetype = 2, colour = 'red') +
geom_vline(xintercept = mean(games), linetype = 2, colour = 'black') +
geom_hline(yintercept = 0) +
theme_minimal() +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
axis.text.x = element_text(size = 12, colour = 'black'),
axis.text.y = element_blank(),
axis.title = element_text(size = 14, colour = 'black'),
strip.background = element_rect(linewidth = 1, colour = 'black', fill = 'grey75'),
strip.text = element_text(size = 12, colour = 'black'),
legend.position = 'none',
plot.caption = element_text(hjust = 0, size = 10))
set.seed(1234) # Set Initial Seed
seeds <-  sample(1:1000, size = 100, replace = FALSE) # Random Seeds
roulette_values <- c(rep("red", 18), rep("black", 18), rep("green", 2)) # Roulette Wheel
games <- c() # Empty Vector to Store Winnings (Losses...)
for (i in 1:length(seeds)){
temp_seed <- seeds[i] # Recover Temporary Seed
set.seed(temp_seed) # Set Temporary Seed
available_colors <- c('red', 'black') # Roulette Colors
remaining_funds <- ifelse(i == 1, 500, games[i-1])  # Starting Money (500 or Previous Start if i > 1)
current_color <- 'red' # Starting with Red
for (spin in 1:100){
temp_spin <- sample(roulette_values, size = 1, replace = T) # Spin!
if (temp_spin == current_color){
remaining_funds <- remaining_funds + 10 # Win :D
current_color = current_color # Keep Color
} else {
remaining_funds <- remaining_funds - 10 # Loss :(
current_color = sample(available_colors[which(!available_colors == current_color)], size = 1, replace = T)
# If Loss -- Remove $10 and Change Color to Other from Remaining Options
}
}
games <- c(games, remaining_funds) # Export Remaining Funds
}
data.frame(remaining_funds = games) %>%
ggplot(aes(x = remaining_funds)) +
geom_histogram(aes(y = after_stat(density)),
fill = 'skyblue4', colour = 'black', alpha = 1/3, bins = 15) +
geom_density(colour = 'red', linetype = 2, size = 1) +
labs(x = '\nRemaining Funds\n',
y = ' ',
fill = 'Sample Size',
caption = paste0(
"Dashed Black Line = Average Remaining Funds After 100 Days $(", round(mean(games), 0), ")"
)) +
geom_vline(xintercept = 500, linetype = 2, colour = 'red') +
geom_vline(xintercept = mean(games), linetype = 2, colour = 'black') +
geom_hline(yintercept = 0) +
theme_minimal() +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
axis.text.x = element_text(size = 12, colour = 'black'),
axis.text.y = element_blank(),
axis.title = element_text(size = 14, colour = 'black'),
strip.background = element_rect(linewidth = 1, colour = 'black', fill = 'grey75'),
strip.text = element_text(size = 12, colour = 'black'),
legend.position = 'none',
plot.caption = element_text(hjust = 0, size = 10))
set.seed(1234) # Set Initial Seed
seeds <-  sample(1:1000, size = 100, replace = FALSE) # Random Seeds
roulette_values <- as.character(c(1:36, "0", "00")) # Roulette Wheel
bond_wins <- as.character(c(19:36, 13:18, "0", "00")) # Numbers Where James Wins
bets <- c(
rep(14, 18),    # 19–36
rep(5, 6),      # 13–18
rep(0.5, 2)     # 0 and 00
) # Bets Associated with Numbers
payouts <- c(
rep(8, 18),     # 19–36: +$8 net
rep(10, 6),     # 13–18: +$10 net
rep(-2, 2)      # 0 and 00: -$2 net
) # Payouts
bond_payouts <- data.frame(
number = bond_wins, # Numbers
bet = bets, # Bet Values
payout = payouts,  # Associated Payouts
stringsAsFactors = F
) # Dataframe to Return Payouts for Winning Numbers # Numbers Where James Wins
games <- c() # Empty Vector to Store Winnings (Losses...)
for (i in 1:length(seeds)){
temp_seed <- seeds[i] # Recover Temporary Seed
set.seed(temp_seed) # Set Temporary Seed
remaining_funds <- ifelse(i == 1, 500, games[i-1])  # Starting Money (500 or Previous Day if i > 1)
for (spin in 1:100){
temp_spin <- sample(roulette_values, size = 1, replace = T) # Spin!
if (temp_spin %in% bond_wins){
temp_payout <- bond_payouts$payout[bond_payouts$number == temp_spin] # Return Temp Payout
remaining_funds <- remaining_funds + temp_payout # Apply Win :D
} else {
remaining_funds <- remaining_funds - 20 # Apply Full $20 Loss :(
}
}
games <- c(games, remaining_funds) # Export Remaining Funds
}
data.frame(remaining_funds = games) %>%
ggplot(aes(x = remaining_funds)) +
geom_histogram(aes(y = after_stat(density)),
fill = 'skyblue4', colour = 'black', alpha = 1/3, bins = 15) +
geom_density(colour = 'red', linetype = 2, size = 1) +
labs(x = '\nRemaining Funds\n',
y = ' ',
fill = 'Sample Size',
caption = paste0(
"Dashed Black Line = Average Remaining Funds After 100 Days $(", round(mean(games), 0), ")"
)) +
geom_vline(xintercept = 500, linetype = 2, colour = 'red') +
geom_vline(xintercept = mean(games), linetype = 2, colour = 'black') +
geom_hline(yintercept = 0) +
theme_minimal() +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
axis.text.x = element_text(size = 12, colour = 'black'),
axis.text.y = element_blank(),
axis.title = element_text(size = 14, colour = 'black'),
strip.background = element_rect(linewidth = 1, colour = 'black', fill = 'grey75'),
strip.text = element_text(size = 12, colour = 'black'),
legend.position = 'none',
plot.caption = element_text(hjust = 0, size = 10))
library(mtcars)
install.packages('mtcars
')
mtcars
mtcars <- mtcars
mtcars
View(mtcars)
mod1 <- lm(mpg~cyl+disp+hp+wt, data = mtcars)
mod2 <- lm(mpg~cyl+disp:wt+hp, data = mtcars)
stargazer::(mod1, mod2)
stargazer::stargazer(mod1, mod2)
stargazer::stargazer(mod1, mod2, type = 'text')
default_ggplot_theme  <- theme_minimal(base_size = 12) +
theme(
plot.title = element_text(hjust = 0.5, size = 12),
axis.title = element_text(size = 12, colour = 'black'),
axis.text = element_text(size = 10, colour = 'black'),
panel.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
)
mtcars %>%
ggplot(aes(x = cyl)) +
geom_density() +
default_ggplot_theme
mtcars %>%
ggplot(aes(x = cyl)) +
geom_density() +
default_ggplot_theme
mtcars %>%
ggplot(aes(x = disp)) +
geom_density() +
default_ggplot_theme
mtcars %>%
ggplot(aes(x = ht)) +
geom_density() +
default_ggplot_theme
mtcars %>%
ggplot(aes(x = hp)) +
geom_density() +
default_ggplot_theme
mtcars %>%
ggplot(aes(x = wt)) +
geom_density() +
default_ggplot_theme
mtcars %>%
ggplot(aes(x = wt)) +
geom_density() +
theme_minimal() +
theme(panel.border = element_rect(size = 1, colour = 'black', fill = NA))
mtcars %>%
ggplot(aes(x = wt)) +
geom_density() +
theme_minimal() +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA))
mod1 <- lm(mpg~cyl+disp+hp+wt, data = mtcars)
mod2 <- lm(mpg~cyl+disp:wt+hp, data = mtcars)
stargazer::stargazer(mod1, mod2, type = 'text')
mtcars %>%
ggplot(aes(x = cyl)) +
geom_density() +
default_ggplot_theme
mtcars %>%
ggplot(aes(x = disp)) +
geom_density() +
default_ggplot_theme
mtcars %>%
ggplot(aes(x = hp)) +
geom_density() +
default_ggplot_theme
mtcars %>%
ggplot(aes(x = wt)) +
geom_density() +
theme_minimal() +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA))
