legend.text = element_text(size = 12))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 12, colour = 'black'),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.text = element_text(size = 12))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 10, colour = 'black'),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.text = element_text(size = 12))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 8, colour = 'black'),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.text = element_text(size = 12))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 8, colour = 'black', vjust = 0.5),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.text = element_text(size = 12))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 8, colour = 'black', hjust = 0.5),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.text = element_text(size = 12))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 8, colour = 'black', vjust = 1),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.text = element_text(size = 12))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 8, colour = 'black', vjust = 5),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.text = element_text(size = 12))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 8, colour = 'black', vjust = -2),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.text = element_text(size = 12))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 8, colour = 'black', hjust = -0.5),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.text = element_text(size = 12))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 8, colour = 'black', hjust = 2),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.text = element_text(size = 12))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 8, colour = 'black', hjust =1),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.text = element_text(size = 12))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 8, colour = 'black'),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.text = element_text(size = 12))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 8, colour = 'black'),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.text = element_text(size = 12, vjust = 0.5))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 8, colour = 'black'),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.text = element_text(size = 12, hjust = 0.5))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 8, colour = 'black'),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.title = element_text(size = 14, hjust = 0.5),
legend.text = element_text(size = 12))
data %>%
mutate(cluster = factor(kmeans_example$cluster)) %>%
ggplot(aes(x = sepal_length, y = sepal_width, color = cluster)) +
geom_point() +
theme_minimal() +
labs(x = '\nSepal Width',
y = 'Sepal Length\n',
colour = 'Cluster Assignment',
title = paste0('K-Means with 3 Cluster Centers (Within-Cluster Sum of Squares = ', round(kmeans_example$tot.withinss, 2), ')')) +
theme(panel.border = element_rect(linewidth = 1, colour = 'black', fill = NA),
title = element_text(size = 8, colour = 'black'),
legend.position = 'bottom',
legend.background = element_rect(linewidth = 1, colour = 'black', fill = NA),
legend.title.position = 'top',
legend.title = element_text(size = 10, hjust = 0.5),
legend.text = element_text(size = 12))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
library(ggplot2)
library(dplyr)
library(cowplot)
library(stargazer)
library(doParallel)
library(parallel)
library(snow)
library(tm)
library(quanteda)
library(gutenbergr)
library(stringr)
data("AssociatedPress")
dtm <- AssociatedPress
library(topicmodels)
install.packages('topicmodels')
library(topicmodels)
data("AssociatedPress")
dtm <- AssociatedPress
dtm
k <- 5 # Assuming 2 Topics
k <- 5 # Assuming 5 Topics
lda_model <- LDA(dtm, k = k, method = "Gibbs", control = list(seed = 1234)) # LDA w/ Gibbs Sampling
terms(lda_model, 5)
terms(lda_model, 10)
topicmodels::terms(lda_model, 10)
topic_probs <- posterior(lda_model)$topics (pi_k)
class(lda_model)
topic_probs <- posterior(lda_model)$topics
topic_probs
print(round(topic_probs, 2))
print(round(topic_probs, 2))[10]
print(round(topic_probs[10], 2))
print(round(topic_probs[,[c(1:10)]], 2))
print(round(topic_probs[1:10], 2))
print(round(topic_probs[c(1:5), 1:10], 2))
print(round(topic_probs[c(1:5), c(1:10)], 2))
topic_probs[c(1:5), c(1:10)]
topic_probs[c(1:10), c(1:5)]
print(round(topic_probs[c(1:10), c(1:5)], 2))
term_probs <- posterior(lda_model)$terms
head(round(word_probs[, 1:2], 3))
word_probs <- posterior(lda_model)$terms
head(round(word_probs[, 1:2], 3))
head(round(word_probs[, 1:2]))
head(round(word_probs[, 1:2], 20))
head(round(word_probs[, 1:2], 5))
head(round(word_probs[, 1:2], 6))
hedad(word_probs)
head(word_probs)
head(sort(as.vector(word_probs), decreasing = TRUE), 10)
head(sort(setNames(as.vector(word_probs), paste0(rep(rownames(word_probs), ncol(word_probs)), "_topic", rep(1:ncol(word_probs), each = nrow(word_probs)))), decreasing = TRUE), 10)
sub("_topic.*", "", names(head(sort(setNames(as.vector(word_probs),
paste0(rep(rownames(word_probs), ncol(word_probs)), "_topic",
rep(1:ncol(word_probs), each = nrow(word_probs)))),
decreasing = TRUE), 10)))
sub("_topic.*", "", names(head(sort(setNames(as.vector(word_probs),
paste0(rep(rownames(word_probs), ncol(word_probs)), "_topic",
rep(1:ncol(word_probs), each = nrow(word_probs)))),
decreasing = TRUE), 10)))
word_probs
head(word_probs)
word_probs <- posterior(lda_model)$terms # Prob Word J In Topic K
word_probs <- posterior(lda_model)$terms # Prob Word J in Topic K
head(round(word_probs[, 1:2], 3))
head(round(word_probs[, 1:2], 9))
head(round(word_probs[, 1:5], 9))
head(round(word_probs[, 1:5], 5))
head(round(word_probs[, 1:5], 6))
head(round(word_probs[, 1:5], 5))
lda_model <- LDA(dtm, k = 5, method = "Gibbs", control = list(seed = 1234)) # LDA w/ 5 Topics & Gibbs Sampling
docs <- dtm_to_stm(AssociatedPress)
library(stm)
docs <- stm::dtm_to_stm(AssociatedPress)
docs <- tm::dtm_to_stm(AssociatedPress)
docs <- prepDocuments(AssociatedPress, vocab = Terms(AssociatedPress), meta = NULL)
docs <- tm::prepDocuments(AssociatedPress, vocab = Terms(AssociatedPress), meta = NULL)
docs <- stm::prepDocuments(AssociatedPress, vocab = Terms(AssociatedPress), meta = NULL)
dtm <- AssociatedPress
docs <- convert(dtm, to = "stm")
dtm <- AssociatedPress
docs <- convert(dtm, to = "stm")
dtm
AssociatedPress[1]
AssociatedPress
head(dtm)
dtm$dimnames
dtm <- AssociatedPress
texts <- apply(dtm, 1, function(x) {
paste(rep(colnames(dtm), x), collapse = " ")
})
texts <- apply(dtm, 1, function(x) {
paste(rep(colnames(dtm), x), collapse = " ")
})
corpus_ap <- corpus(texts)
corpus_ap <- corpus(texts)
dfm_ap <- dfm(corpus_ap)
dfm_ap <- dfm(tokens(corpusap))
dfm_ap <- dfm(tokens(corpus_ap))
# Convert dfm to STM format
docs_stm <- convert(dfm_ap, to = "stm")
stm_model <- stm(documents = docs_stm$documents,
vocab = docs_stm$vocab,
K = 5,
prevalence = ~1,
init.type = "Spectral")
docs_stm
stm_model <- stm(documents = docs_stm$documents,
vocab = docs_stm$vocab,
K = 5,
prevalence = ~1,
init.type = "Spectral")
stm_model <- stm(
documents = docs_stm$documents,
vocab     = docs_stm$vocab,
K         = 5,
prevalence = ~1,
data      = NULL,
init.type = "Spectral"
)
stm_model <- stm(
documents = docs_stm$documents,
vocab     = docs_stm$vocab,
K         = 5,
prevalence = ~1,
data      = docs_stm$meta,
init.type = "Spectral"
)
docs_stm$vocab
texts <- apply(AssociatedPress, 1, function(x) {
paste(rep(colnames(dtm), x), collapse = " ")
})
reduce_complexity <- function(text){
text <- tolower(text) # Lower Case
text <- tm::removePunctuation(text) # Punctuation
text <- tm::removeNumbers(text) # Numbers
text <- removeWords(text, tm::stopwords("english")) # Stop Words
text <- unlist(stringr::str_split(text, '\\s+')) # Tokenize
text <- textstem::lemmatize_words(text) # Lemmatize
text <- paste(text, collapse = ' ') # Re-Append
text <- gsub("\\s{2,}", ' ', text) # 2 or More Spaces --> One Space
text <- trimws(text) # White Space
return(text)
}
texts_reduced <- reduce_complexity(texts)
corpus_reduced <- VCorpus(VectorSource(texts_reduced))
dtm_reduced <- DocumentTermMatrix(
corpus_reduced,
control = list(wordLengths = c(1, Inf))
)
dfm_ap <- dfm(tokens(dfm_reduced)
dfm_ap <- dfm(tokens(dfm_reduced))
texts <- apply(AssociatedPress, 1, function(x) {
paste(rep(colnames(AssociatedPress), x), collapse = " ")
})
corpus_reduced <- VCorpus(VectorSource(texts_reduced))
dtm_reduced <- DocumentTermMatrix(
corpus_reduced,
control = list(wordLengths = c(1, Inf))
)
dfm_ap <- dfm(tokens(dfm_reduced))
dfm_ap <- as.dfm(dtm_reduced)
docs_stm <- convert(dfm_ap, to = "stm")
docs_stm$meta
stm_model <- stm::stm(
documents = docs_stm$documents,
vocab     = docs_stm$vocab,
K         = 5,
prevalence = ~1,
data      = NULL,
init.type = "Spectral",
seed = 1234,
max.em.its = 500,
verbose = F
)
stm_model <- stm::stm(
documents = docs_stm$documents,
vocab     = docs_stm$vocab,
K         = 5,
prevalence = ~1,
data      = NULL,
init.type = "Spectral",
seed = 1234,
max.em.its = 500,
verbose = F
)
length(docs_stm$documents) == 1
texts <- apply(AssociatedPress, 1, function(x) {
paste(rep(colnames(AssociatedPress), x), collapse = " ")
})
texts <- apply(AssociatedPress, 1, function(x) {
paste(rep(colnames(AssociatedPress), x), collapse = " ")
})
reduce_complexity <- function(text){
text <- tolower(text) # Lower Case
text <- tm::removePunctuation(text) # Punctuation
text <- tm::removeNumbers(text) # Numbers
text <- removeWords(text, tm::stopwords("english")) # Stop Words
text <- unlist(stringr::str_split(text, '\\s+')) # Tokenize
text <- textstem::lemmatize_words(text) # Lemmatize
text <- paste(text, collapse = ' ') # Re-Append
text <- gsub("\\s{2,}", ' ', text) # 2 or More Spaces --> One Space
text <- trimws(text) # White Space
return(text)
} # Complexity Reduction (See Class 5!)
texts_reduced <- vapply(texts, reduce_complexity, character(1))
texts <- apply(AssociatedPress, 1, function(x) {
paste(rep(colnames(AssociatedPress), x), collapse = " ")
})
reduce_complexity <- function(text){
text <- tolower(text) # Lower Case
text <- tm::removePunctuation(text) # Punctuation
text <- tm::removeNumbers(text) # Numbers
text <- removeWords(text, tm::stopwords("english")) # Stop Words
text <- unlist(stringr::str_split(text, '\\s+')) # Tokenize
text <- textstem::lemmatize_words(text) # Lemmatize
text <- paste(text, collapse = ' ') # Re-Append
text <- gsub("\\s{2,}", ' ', text) # 2 or More Spaces --> One Space
text <- trimws(text) # White Space
return(text)
} # Complexity Reduction (See Class 5!)
texts_reduced <- vapply(texts, reduce_complexity, character(1))
corpus_reduced <- VCorpus(VectorSource(texts_reduced))
dtm_reduced <- DocumentTermMatrix(
corpus_reduced,
control = list(wordLengths = c(1, Inf))
)
dfm_ap <- as.dfm(dtm_reduced)
docs_stm <- convert(dfm_ap, to = "stm")
stm_model <- stm::stm(
documents = docs_stm$documents,
vocab     = docs_stm$vocab,
K         = 5,
prevalence = ~1,
data      = NULL,
init.type = "Spectral",
seed = 1234,
max.em.its = 500,
verbose = F
)
meta <- data.frame(dummy = rep(1, length(docs_stm$documents)))
stm_model <- stm::stm(
documents  = docs_stm$documents,
vocab      = docs_stm$vocab,
K          = 5,
prevalence = ~1,
data       = meta,
init.type  = "Spectral",
seed       = 1234,
max.em.its = 500,
verbose    = FALSE
)
View(meta)
stm_model$mu
stm::LabelTopics(stm_model, n = 10)
LabelTopics(stm_model, n = 10)
stm::labelTopics(stm_model, n = 10)
proportions <- stm_model$theta
round(theta[1:10, ], 2)
stm::labelTopics(stm_model, n = 10) # Top Words/Topic
proportions <- stm_model$theta
round(proportions[1:10, ], 2)
topic_word_probs <- exp(stm_model$beta$logbeta[[1]]) #Topic Word Probabilities
head(round(topic_word_probs[,1:5], 5))
print(stm_model)
summary(stm_model$theta)
labelTopics(stm_model, n = 10)
round(colMeans(stm_model$theta), 3)
